---
interface Props {
  title?: string;
  description?: string;
}
const {
  title = "tractiva — Google Ads que Sí Generan Consultas",
  description = "Gestionamos campañas de Google Ads para profesionales en Chile que necesitan clientes reales cada mes. Sin contratos.",
} = Astro.props;
import "../styles/global.css";
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title}</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="scroll-progress" id="scroll-progress"></div>
    <slot />
    <script>
      // Scroll reveals + keyword underlines
      const obs = new IntersectionObserver(
        (entries) => {
          entries.forEach((e) => {
            if (e.isIntersecting) {
              e.target.classList.add("is-visible");
              obs.unobserve(e.target);
            }
          });
        },
        { threshold: 0.12, rootMargin: "0px 0px -40px 0px" },
      );
      document
        .querySelectorAll(".reveal, .line-reveal, .keyword")
        .forEach((el) => obs.observe(el));

      // Scroll progress line
      const prog = document.getElementById("scroll-progress");
      if (prog) {
        const updateProgress = () => {
          const h = document.documentElement.scrollHeight - window.innerHeight;
          const pct = h > 0 ? (window.scrollY / h) * 100 : 0;
          prog.style.height = pct + "%";
          prog.classList.toggle("is-active", pct > 1 && pct < 99);
        };
        window.addEventListener("scroll", updateProgress, { passive: true });
        updateProgress();
      }

      // Navbar scroll
      const nav = document.getElementById("site-nav");
      if (nav) {
        const onScroll = () =>
          nav.classList.toggle("is-scrolled", window.scrollY > 40);
        window.addEventListener("scroll", onScroll, { passive: true });
        onScroll();
      }

      // Brand flip loop
      const flips = document.querySelectorAll(".brand-flip");
      if (flips.length) {
        setInterval(() => {
          flips.forEach((f) => f.classList.add("is-flipped"));
          setTimeout(
            () => flips.forEach((f) => f.classList.remove("is-flipped")),
            1500,
          );
        }, 5000);
      }

      // Service list toggle
      document.querySelectorAll(".service-row").forEach((row) => {
        row.addEventListener("click", () => {
          const item = row.closest(".service-item");
          if (!item) return;
          const wasOpen = item.classList.contains("is-open");
          document
            .querySelectorAll(".service-item.is-open")
            .forEach((i) => i.classList.remove("is-open"));
          if (!wasOpen) item.classList.add("is-open");
        });
      });

      // FAQ accordion
      document.querySelectorAll(".faq-trigger").forEach((trigger) => {
        trigger.addEventListener("click", () => {
          const item = trigger.closest(".faq-item");
          if (!item) return;
          const wasOpen = item.classList.contains("is-open");
          document.querySelectorAll(".faq-item.is-open").forEach((i) => {
            i.classList.remove("is-open");
            i.querySelector(".faq-trigger")?.setAttribute(
              "aria-expanded",
              "false",
            );
          });
          if (!wasOpen) {
            item.classList.add("is-open");
            trigger.setAttribute("aria-expanded", "true");
          }
        });
      });
    </script>
  </body>
</html>
